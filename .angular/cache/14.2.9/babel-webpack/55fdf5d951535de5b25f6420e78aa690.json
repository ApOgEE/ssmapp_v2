{"ast":null,"code":"import { __awaiter } from \"tslib\";\nimport { NavController } from '@ionic/angular';\nimport { NativeStorage } from '@awesome-cordova-plugins/native-storage/ngx';\nimport { QRScannerService } from '../services/qrscanner.service';\nimport { SsmloadingService } from '../services/ssmloading.service';\nimport { TranslateService } from '@ngx-translate/core';\nimport { AlertPromptComponent } from '../components/alert-prompt/alert-prompt.component';\nimport { InAppBrowser } from '@awesome-cordova-plugins/in-app-browser/ngx';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@awesome-cordova-plugins/in-app-browser/ngx\";\nimport * as i2 from \"@ionic/angular\";\nimport * as i3 from \"@awesome-cordova-plugins/native-storage/ngx\";\nimport * as i4 from \"../services/qrscanner.service\";\nimport * as i5 from \"../services/ssmloading.service\";\nimport * as i6 from \"@ngx-translate/core\";\nimport * as i7 from \"@angular/common\";\nimport * as i8 from \"../components/ssmfooter/ssmfooter.component\";\n\nfunction BiztrustResultPage_div_36_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 17);\n    i0.ɵɵlistener(\"click\", function BiztrustResultPage_div_36_Template_div_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r6);\n      const url_r3 = restoredCtx.$implicit;\n      const ctx_r5 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r5.openLink(url_r3));\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const url_r3 = ctx.$implicit;\n    const i_r4 = ctx.index;\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate2(\"(\", ctx_r0.toRoman(i_r4 + 1), \") \", url_r3, \"\");\n  }\n}\n\nfunction BiztrustResultPage_div_37_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 18);\n    i0.ɵɵlistener(\"click\", function BiztrustResultPage_div_37_Template_div_click_0_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r7 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r7.seeMoreUrl());\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵelement(3, \"i\", 19);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(2, 1, \"SEEMORE\"), \"\");\n  }\n}\n\nfunction BiztrustResultPage_div_38_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r12 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 20);\n    i0.ɵɵlistener(\"click\", function BiztrustResultPage_div_38_Template_div_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r12);\n      const url_r9 = restoredCtx.$implicit;\n      const ctx_r11 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r11.openLink(url_r9));\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const url_r9 = ctx.$implicit;\n    const i_r10 = ctx.index;\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"hidden\", !ctx_r2.seeMore);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate2(\"(\", ctx_r2.toRoman(i_r10 + 4), \") \", url_r9, \"\");\n  }\n}\n\nexport let BiztrustResultPage = /*#__PURE__*/(() => {\n  class BiztrustResultPage {\n    constructor(inAppBrowser, navCtrl, storage, qrScannerSvc, ssmloadingSvc, translate) {\n      this.inAppBrowser = inAppBrowser;\n      this.navCtrl = navCtrl;\n      this.storage = storage;\n      this.qrScannerSvc = qrScannerSvc;\n      this.ssmloadingSvc = ssmloadingSvc;\n      this.translate = translate;\n      this.mainurl = [];\n      this.moreaddurl = [];\n      this.alertPrompt = new AlertPromptComponent(this.navCtrl);\n      let currentDate = new Date();\n      this.todayDate = currentDate.toLocaleDateString('en-MY');\n      this.qrScanData = {\n        errorMsg: null,\n        successCode: null,\n        entityNo: null,\n        checkDigit: null,\n        entityNoNew: null,\n        entityName: null,\n        statusCode: null,\n        statusDescription: null,\n        url: null,\n        mainUrl: null,\n        addUrl: [],\n        version: 0,\n        entityType: null\n      };\n    }\n\n    ngOnInit() {\n      return __awaiter(this, void 0, void 0, function* () {\n        let resData = yield this.storage.getItem('queryResult');\n        console.log(\"QR Data : \" + resData);\n        var jsonObj = JSON.parse(resData);\n        this.qrScanData = jsonObj;\n\n        if (this.qrScanData.successCode !== \"00\") {\n          this.goTo('/biztrust-error');\n        } else {\n          let mainurlarray = [];\n          if (this.qrScanData.mainUrl != null) mainurlarray.push(this.qrScanData.mainUrl);\n          let addurlarray = [];\n          if (this.qrScanData.addUrl != null) addurlarray = this.qrScanData.addUrl;\n\n          const concatarray = (...arrays) => [].concat(...arrays.filter(Array.isArray));\n\n          const arr = concatarray(mainurlarray, addurlarray);\n          var urlList = arr.filter(function (elem, index, self) {\n            return index === self.indexOf(elem);\n          });\n          console.log(\"Url list: \" + urlList);\n          const urlListSize = urlList.length;\n          console.log(\"Url list size: \" + urlListSize);\n\n          if (urlListSize > 3) {\n            this.mainurl = urlList.slice(0, 3);\n            this.moreaddurl = urlList.slice(3);\n          } else {\n            this.mainurl = urlList.slice();\n          }\n\n          console.log(\"mainurl: \" + this.mainurl);\n          console.log(\"moreaddurl: \" + this.moreaddurl);\n        }\n      });\n    }\n\n    goTo(page) {\n      if (page === \"biztrust-scan\") this.navCtrl.navigateBack(page);else this.navCtrl.navigateForward(page);\n    }\n\n    seeMoreUrl() {\n      this.seeMore = !this.seeMore;\n      console.log(\"Click seemore: \" + this.seeMore);\n    }\n\n    scanQRCode() {\n      this.qrScannerSvc.scanQRCode().then(res => {\n        if (res === \"NetworkError\") {\n          this.goTo('/biztrust-connection-error');\n          return;\n        }\n\n        this.queryBizTrust(res);\n      }, err => {\n        console.log('Error', err);\n      });\n    }\n\n    queryBizTrust(barcodetext) {\n      return __awaiter(this, void 0, void 0, function* () {\n        yield this.ssmloadingSvc.showLoader();\n        this.qrScannerSvc.bizTrustQuery(barcodetext).then(result => {\n          console.log(\"Result returned: \" + result);\n          this.ssmloadingSvc.hideLoader().then(() => {\n            if (result === \"Fail\") {\n              console.log(\"Fail\");\n              return;\n            }\n\n            if (result === \"Error\") {\n              this.navCtrl.navigateForward('/biztrust-error');\n              return;\n            } // success\n\n\n            this.qrScannerSvc.saveResult(result).then(res => {\n              this.ngOnInit();\n              return;\n            });\n          });\n        }, err => {\n          this.ssmloadingSvc.hideLoader().then(() => {\n            console.log(JSON.stringify(err));\n            console.log(err.status);\n            this.alertPrompt.presentServerFail(this.translate.instant('MENU_09'), err.status, false);\n          });\n        });\n      });\n    }\n\n    toRoman(num) {\n      if (num < 1) {\n        return \"\";\n      }\n\n      if (num >= 40) {\n        return \"xl\" + this.toRoman(num - 40);\n      }\n\n      if (num >= 10) {\n        return \"x\" + this.toRoman(num - 10);\n      }\n\n      if (num >= 9) {\n        return \"ix\" + this.toRoman(num - 9);\n      }\n\n      if (num >= 5) {\n        return \"v\" + this.toRoman(num - 5);\n      }\n\n      if (num >= 4) {\n        return \"iv\" + this.toRoman(num - 4);\n      }\n\n      if (num >= 1) {\n        return \"i\" + this.toRoman(num - 1);\n      }\n    }\n\n    openLink(link) {\n      this.inAppBrowser.create(link, '_system');\n    }\n\n  }\n\n  BiztrustResultPage.ɵfac = function BiztrustResultPage_Factory(t) {\n    return new (t || BiztrustResultPage)(i0.ɵɵdirectiveInject(i1.InAppBrowser), i0.ɵɵdirectiveInject(i2.NavController), i0.ɵɵdirectiveInject(i3.NativeStorage), i0.ɵɵdirectiveInject(i4.QRScannerService), i0.ɵɵdirectiveInject(i5.SsmloadingService), i0.ɵɵdirectiveInject(i6.TranslateService));\n  };\n\n  BiztrustResultPage.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: BiztrustResultPage,\n    selectors: [[\"app-biztrust-result\"]],\n    decls: 45,\n    vars: 27,\n    consts: [[1, \"bar-class\"], [\"slot\", \"start\"], [\"text\", \"Back\", 2, \"text-transform\", \"none\", 3, \"click\"], [\"slot\", \"end\"], [\"src\", \"assets/images/icon_qr.png\", 2, \"height\", \"32px\", \"width\", \"32px\", 3, \"click\"], [2, \"padding-left\", \"10px\", \"padding-right\", \"10px\"], [1, \"design\", 2, \"padding-top\", \"20px\", \"padding-bottom\", \"20px\", \"margin-left\", \"20px\", \"margin-right\", \"20px\", \"margin-top\", \"20px\", \"border-radius\", \"15px\"], [1, \"ion-justify-content-center\", \"ion-text-center\"], [2, \"font-size\", \"18px\", \"color\", \"#2E2F83\", \"font-weight\", \"bold\"], [1, \"ion-justify-content-center\", \"ion-text-center\", 2, \"display\", \"inline\"], [1, \"biztrust-title\"], [1, \"biztrust-item\"], [1, \"biztrust-item2\"], [\"class\", \"biztrust-item3\", 3, \"click\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"biztrust-item4\", 3, \"click\", 4, \"ngIf\"], [\"class\", \"biztrust-item3\", 3, \"hidden\", \"click\", 4, \"ngFor\", \"ngForOf\"], [2, \"font-size\", \"13px\", \"text-align\", \"left\", \"margin-left\", \"20px\", \"padding-bottom\", \"30px\"], [1, \"biztrust-item3\", 3, \"click\"], [1, \"biztrust-item4\", 3, \"click\"], [1, \"icon\", \"ion-chevron-down\"], [1, \"biztrust-item3\", 3, \"hidden\", \"click\"]],\n    template: function BiztrustResultPage_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"ion-header\")(1, \"ion-toolbar\", 0)(2, \"ion-buttons\", 1)(3, \"ion-back-button\", 2);\n        i0.ɵɵlistener(\"click\", function BiztrustResultPage_Template_ion_back_button_click_3_listener() {\n          return ctx.goTo(\"/biztrust-scan\");\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(4, \"ion-buttons\", 3)(5, \"img\", 4);\n        i0.ɵɵlistener(\"click\", function BiztrustResultPage_Template_img_click_5_listener() {\n          return ctx.scanQRCode();\n        });\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(6, \"ion-content\")(7, \"div\", 5)(8, \"ion-card\", 6)(9, \"ion-card-content\")(10, \"ion-grid\")(11, \"ion-row\", 7)(12, \"div\", 8);\n        i0.ɵɵtext(13);\n        i0.ɵɵpipe(14, \"translate\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(15, \"ion-row\", 9)(16, \"div\", 10);\n        i0.ɵɵtext(17);\n        i0.ɵɵpipe(18, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(19, \"div\", 11);\n        i0.ɵɵtext(20);\n        i0.ɵɵpipe(21, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(22, \"div\", 12);\n        i0.ɵɵtext(23);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(24, \"div\", 11);\n        i0.ɵɵtext(25);\n        i0.ɵɵpipe(26, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(27, \"div\", 12);\n        i0.ɵɵtext(28);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(29, \"div\", 11);\n        i0.ɵɵtext(30, \"Status\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(31, \"div\", 12);\n        i0.ɵɵtext(32);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(33, \"div\", 11);\n        i0.ɵɵtext(34);\n        i0.ɵɵpipe(35, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(36, BiztrustResultPage_div_36_Template, 2, 2, \"div\", 13);\n        i0.ɵɵtemplate(37, BiztrustResultPage_div_37_Template, 4, 3, \"div\", 14);\n        i0.ɵɵtemplate(38, BiztrustResultPage_div_38_Template, 2, 3, \"div\", 15);\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(39, \"div\", 16)(40, \"label\");\n        i0.ɵɵtext(41);\n        i0.ɵɵpipe(42, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(43, \"br\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelement(44, \"app-ssmfooter\");\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(13);\n        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(14, 15, \"GREAT\"));\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(18, 17, \"CORPORATEINFO\"));\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(21, 19, \"BTREGNUMBER\"));\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate3(\"\", ctx.qrScanData.entityNoNew, \" (\", ctx.qrScanData.entityNo, \"-\", ctx.qrScanData.checkDigit, \")\");\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(26, 21, \"NAME\"));\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate(ctx.qrScanData.entityName);\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate(ctx.qrScanData.statusDescription);\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(35, 23, \"URLLINKS\"));\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngForOf\", ctx.mainurl);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.moreaddurl.length > 0 && !ctx.seeMore);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngForOf\", ctx.moreaddurl);\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate2(\"\", i0.ɵɵpipeBind1(42, 25, \"ASAT\"), \": \", ctx.todayDate, \"\");\n      }\n    },\n    dependencies: [i7.NgForOf, i7.NgIf, i2.IonBackButton, i2.IonButtons, i2.IonCard, i2.IonCardContent, i2.IonContent, i2.IonGrid, i2.IonHeader, i2.IonRow, i2.IonToolbar, i2.IonBackButtonDelegate, i8.SsmfooterComponent, i6.TranslatePipe],\n    styles: [\"ion-row[_ngcontent-%COMP%]{border-bottom:0px solid #aeb7ca;padding:5px}ion-row.no-border[_ngcontent-%COMP%]{border-bottom:0px}ion-col.no-border[_ngcontent-%COMP%]{border-bottom:0px}ion-button.findbutton[_ngcontent-%COMP%]{--background: #2E2F83;--color: #F9EC00;--border-color: #2E2F83}ion-content[_ngcontent-%COMP%]{--overflow: visible;height:auto;--background: white}ion-select.overflow[_ngcontent-%COMP%]{width:100%;direction:ltr;position:inherit;padding-left:0;--overflow: hidden}.page-background-image[_ngcontent-%COMP%]{background:linear-gradient(rgba(255,255,255,.9),rgba(255,255,255,.9)),url(/assets/images/logo_biztrust.png);background-size:80%;background-repeat:no-repeat;background-position:center;width:100%;height:100%}.biztrust-title[_ngcontent-%COMP%]{color:#2e2f83;font-size:15px;font-weight:700;margin-top:20px}.biztrust-item[_ngcontent-%COMP%]{color:#2e2f83;font-size:14px;font-weight:700;margin-top:20px}.biztrust-item2[_ngcontent-%COMP%]{color:#000;font-size:14px}.biztrust-item3[_ngcontent-%COMP%]{color:#2e2f83;font-size:14px;text-align:left;margin-left:20px}.biztrust-item4[_ngcontent-%COMP%]{color:#db1818;font-size:14px}.vertical-center[_ngcontent-%COMP%]{margin:0;position:absolute;top:50%;transform:translateY(-50%)}.design[_ngcontent-%COMP%]{background:linear-gradient(rgba(255,255,255,.8),rgba(255,255,255,.8)),url(/assets/images/logo_biztrust.png);background-size:contain;background-repeat:no-repeat;background-position:center}.card-md[_ngcontent-%COMP%]{margin:0}\"]\n  });\n  return BiztrustResultPage;\n})();","map":null,"metadata":{},"sourceType":"module"}